(()=>{class e{constructor(){this.pages=[],this.touchStartX=0,this.touchEndX=0,this.touchStartY=0,this.breakingNews=[{news:`Days 'til bday: "${this.bday().m}" months and "${this.bday().d}" days.`}],this.__lastBreakingNewsIndex=0}ui=()=>{document.querySelectorAll(".swipeable").forEach((e=>{e.addEventListener("mouseleave",(async t=>{var a=e.closest("article");a.classList.remove("right"),a.classList.remove("left")}),{passive:!0}),e.addEventListener("mousemove",(async t=>{const a=t.clientX-e.getBoundingClientRect().left,s=e.offsetWidth/2;var i=e.closest("article");i.classList.remove("right"),i.classList.remove("left"),a>s?i.classList.add("left"):i.classList.add("right")})),e.addEventListener("click",(t=>{const a=t.clientX-e.getBoundingClientRect().left,s=e.offsetWidth/2;var i=t.target.closest(".swipeable"),n=parseInt(i.dataset.pageIndex),c=a>s;this.swipe(i.dataset.page,n,i.dataset.pageDescription,c)}),{passive:!0}),e.addEventListener("touchstart",(async e=>{this.touchStartX=e.touches[0].clientX,this.touchStartY=e.touches[0].clientY,e.target.classList.add("swiping")}),{passive:!0}),document.addEventListener("touchmove",(async e=>{e.touches[0].clientY>this.touchStartY&&e.preventDefault()}),{passive:!0}),e.addEventListener("touchend",(async e=>{e.target.classList.remove("swiping"),this.touchEndX=e.changedTouches[0].clientX;var t=e.target.closest(".swipeable"),a=parseInt(t.dataset.pageIndex),s=this.touchEndX-this.touchStartX;let i=!0;0!=s&&(s>0&&Math.abs(s)>60?i=!1:Math.abs(s)>60&&(i=!0),this.swipe(t.dataset.page,a,t.dataset.pageDescription,i))}),{passive:!0})}))};defaultOrCachePages=async()=>{this.pages=[],document.querySelectorAll("article[data-page]").forEach((async e=>{let t={name:e.dataset.page,index:0,max:parseInt(e.dataset.pageMax),description:e.dataset.pageDescription};this.pages.currentPage=1,this.pages.push(t)})),sessionStorage.setItem("_cache",JSON.stringify(this.pages))};get=async e=>{const t=await fetch(`leaf/${e}.html`);return await t.text()};placeHolder=async(e,t,a)=>a.replace(e,t);swipe=async(e,t,a,s)=>{var i=this.pages.find((t=>t.name==e));s?t++:t--;let n=document.querySelectorAll(`section[data-page="${e}"][data-page-index="${t}"]`)[0];void 0!==n&&(s?n.classList.add("page-flip"):n.classList.add("page-flip-reverse"),n.addEventListener("animationend",(e=>{e.target.classList.remove("page-flip"),e.target.classList.remove("page-flip-reverse")}),{passive:!0}),i&&(i.index=t),document.querySelectorAll(`section[data-page=${e}]`).forEach((async a=>{parseInt(a.dataset.pageIndex)!=t?a.classList.add("hidden"):a.classList.remove("hidden"),document.querySelectorAll(`span[data-page="${e}"]`).forEach((e=>{e.classList.remove("active")})),document.querySelectorAll(`span[data-page="${e}"][data-page-index="${t}"]`).forEach((e=>{e.classList.add("active")})),document.querySelector(`article[data-page="${e}"] > h2`).innerHTML=`${i.description}`})),sessionStorage.setItem("_cache",JSON.stringify(this.pages)))};init=async()=>{this.find("main header").innerHTML=await this.get("header"),this.find("#socialMedia").innerHTML=await this.get("socialMedia"),this.pages=await this.defaultOrCachePages(),await this.restore(),this.ui(),this.startBreakingNews()};bday=()=>{let e=new Date((new Date).getFullYear(),3,5),t=new Date,a=Math.round((e-t)/864e5);return{d:a%30,m:Math.floor(a/30)}};find=e=>document.querySelector(e);updateBreakingNews=async()=>{document.getElementById("__breakingNews").innerText=await this.getBreakingNews()};startBreakingNews=async()=>{this.updateBreakingNews()};getBreakingNews=async()=>this.breakingNews[this.__lastBreakingNewsIndex].news;restore=async()=>{this.pages=JSON.parse(sessionStorage.getItem("_cache")),this.pages.forEach((e=>{this.swipe(e.name,parseInt(e.index),e.description,!0)}))}}document.addEventListener("DOMContentLoaded",(async()=>{const t=new e;await t.init()}),{passive:!0})})();